<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>奇瑞商用车数字服务价值体系</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    <style>
        /* 页面头部样式 */
        .page-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px 0;
            background-color: #00796b;
            position: relative;
        }

        .main-title {
            font-size: 24px;
            color: white;
            margin: 0 0 10px 0;
            font-weight: bold;
        }

        .sub-title {
            font-size: 18px;
            color: rgba(255, 255, 255, 0.9);
        }

        /* 返回按钮样式 */
        .back-button {
            position: absolute;
            left: 30px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            text-decoration: none;
            font-size: 14px;
        }

        .back-button:hover {
            text-decoration: underline;
        }

        /* 页面布局 */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f8f9fa;
        }

        .page-layout {
            display: flex;
            max-width: 1800px;
            margin: 0 auto;
            gap: 30px;
            padding: 0 30px;
            align-items: flex-start;
            position: relative;
            min-height: calc(100vh - 180px);
        }

        /* 左侧内容区域 */
        .content-left {
            flex: 3;
            display: flex;
            gap: 30px;
        }

        /* 右侧结果区域 */
        .content-right {
            flex: 1;
            background: white;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            height: calc(100vh - 180px);
            position: sticky;
            top: 20px;
        }

        .result-scroll-container {
            height: 100%;
            overflow-y: auto;
            padding: 20px;
        }

        /* 美化滚动条 */
        .result-scroll-container::-webkit-scrollbar {
            width: 6px;
        }

        .result-scroll-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .result-scroll-container::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 3px;
        }

        .result-scroll-container::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* 左侧标题栏 */
        .title-column {
            width: 150px;
            display: flex;
            flex-direction: column;
        }

        .title-box {
            border: 2px dashed #004d99;
            height: 60px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: #004d99;
            font-size: 14px;
            background: white;
            box-sizing: border-box;
        }

        /* 主要内容区 */
        .main-content {
            flex: 1;
        }

        /* 价值分类行 */
        .category-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            gap: 20px;
        }

        .category-item {
            flex: 1;
            height: 80px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 8px;
            background: white;
            text-align: center;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            color: #004d99;
            font-weight: bold;
            padding: 10px;
        }

        /* 价值维度网格 */
        .value-grid {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            margin-top: 40px;
        }

        .value-column {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .dimension-box {
            background: white;
            border: 1px solid #004d99;
            border-radius: 8px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
        }

        .dimension-box span {
            color: #004d99;
            font-weight: bold;
            text-align: center;
        }

        .score-input {
            width: 60px;
            padding: 5px;
            border: 1px solid #004d99;
            border-radius: 4px;
            text-align: center;
        }

        /* 结果区域样式 */
        .result-section {
            margin-bottom: 30px;
        }

        .chart-container {
            height: 300px;
            margin: 20px 0;
        }

        .result-section h3 {
            margin: 0 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #00796b;
            color: #00796b;
        }

        /* 计算按钮 */
        .calculate-btn {
            padding: 10px 20px;
            background: #00796b;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin: 10px 0;
        }

        .calculate-btn:hover {
            background: #00635a;
        }

        .button-container {
            text-align: right;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <!-- 页面头部 -->
    <div class="page-header">
        <a href="index.html" class="back-button">返回首页</a>
        <h1 class="main-title">奇瑞商用车数字服务价值体系</h1>
        <div class="sub-title">价值评估表</div>
    </div>

    <div class="page-layout">
        <!-- 左侧内容区域 -->
        <div class="content-left">
            <!-- 左侧标题栏 -->
            <div class="title-column">
                <div class="title-box">价值分类</div>
                <div class="title-box" style="margin-top: 100px;">价值维度一级</div>
            </div>

            <!-- 主要内容区 -->
            <div class="main-content">
                <!-- 价值分类行 -->
                <div class="category-row">
                    <div class="category-item">
                        <span>商业影响</span>
                        <input type="number" class="score-input" min="0" max="10" value="0">
                    </div>
                    <div class="category-item">
                        <span>行业影响</span>
                        <input type="number" class="score-input" min="0" max="10" value="0">
                    </div>
                    <div class="category-item">
                        <span>客户影响</span>
                        <input type="number" class="score-input" min="0" max="10" value="0">
                    </div>
                    <div class="category-item">
                        <span>创新影响</span>
                        <input type="number" class="score-input" min="0" max="10" value="0">
                    </div>
                    <div class="category-item">
                        <span>环境影响</span>
                        <input type="number" class="score-input" min="0" max="10" value="0">
                    </div>
                </div>

                <!-- 价值分类计算按钮 -->
                <div class="button-container">
                    <button class="calculate-btn" onclick="calculateCategoryWeights()">计算价值分类权重</button>
                </div>

                <!-- 价值维度网格 -->
                <div class="value-grid">
                    <!-- 商业影响列 -->
                    <div class="value-column">
                        <div class="dimension-box">
                            <span>效率提升</span>
                            <input type="number" class="score-input" min="0" max="10" value="0">
                        </div>
                        <div class="dimension-box">
                            <span>时间节省</span>
                            <input type="number" class="score-input" min="0" max="10" value="0">
                        </div>
                        <div class="dimension-box">
                            <span>成本降低</span>
                            <input type="number" class="score-input" min="0" max="10" value="0">
                        </div>
                    </div>

                    <!-- 行业影响列 -->
                    <div class="value-column">
                        <div class="dimension-box">
                            <span>本地化</span>
                            <input type="number" class="score-input" min="0" max="10" value="0">
                        </div>
                        <div class="dimension-box">
                            <span>电动化</span>
                            <input type="number" class="score-input" min="0" max="10" value="0">
                        </div>
                        <div class="dimension-box">
                            <span>标准化</span>
                            <input type="number" class="score-input" min="0" max="10" value="0">
                        </div>
                    </div>

                    <!-- 客户影响列 -->
                    <div class="value-column">
                        <div class="dimension-box">
                            <span>客制化</span>
                            <input type="number" class="score-input" min="0" max="10" value="0">
                        </div>
                        <div class="dimension-box">
                            <span>用户体验</span>
                            <input type="number" class="score-input" min="0" max="10" value="0">
                        </div>
                        <div class="dimension-box">
                            <span>可负担</span>
                            <input type="number" class="score-input" min="0" max="10" value="0">
                        </div>
                    </div>

                    <!-- 创新影响列 -->
                    <div class="value-column">
                        <div class="dimension-box">
                            <span>数智化</span>
                            <input type="number" class="score-input" min="0" max="10" value="0">
                        </div>
                        <div class="dimension-box">
                            <span>制造服务化</span>
                            <input type="number" class="score-input" min="0" max="10" value="0">
                        </div>
                        <div class="dimension-box">
                            <span>人本化</span>
                            <input type="number" class="score-input" min="0" max="10" value="0">
                        </div>
                        <div class="dimension-box">
                            <span>ESG数据化</span>
                            <input type="number" class="score-input" min="0" max="10" value="0">
                        </div>
                    </div>

                    <!-- 环境影响列 -->
                    <div class="value-column">
                        <div class="dimension-box">
                            <span>可持续性</span>
                            <input type="number" class="score-input" min="0" max="10" value="0">
                        </div>
                        <div class="dimension-box">
                            <span>新能源化</span>
                            <input type="number" class="score-input" min="0" max="10" value="0">
                        </div>
                        <div class="dimension-box">
                            <span>物质循环</span>
                            <input type="number" class="score-input" min="0" max="10" value="0">
                        </div>
                    </div>
                </div>

                <!-- 价值维度计算按钮 -->
                <div class="button-container">
                    <button class="calculate-btn" onclick="calculateDimensionWeights()">计算价值维度权重</button>
                </div>
            </div>
        </div>

        <!-- 右侧结果区域 -->
        <div class="content-right">
            <div class="result-scroll-container">
                <div class="result-container">
                    <div id="categoryResult" class="result-section">
                        <h3>价值分类权重结果</h3>
                        <div class="chart-container">
                            <canvas id="categoryChart"></canvas>
                        </div>
                    </div>
                    
                    <div id="商业影响Result" class="result-section dimension-result">
                        <h3>商业影响维度权重</h3>
                        <div class="chart-container">
                            <canvas id="商业影响Chart"></canvas>
                        </div>
                    </div>
                    
                    <div id="行业影响Result" class="result-section dimension-result">
                        <h3>行业影响维度权重</h3>
                        <div class="chart-container">
                            <canvas id="行业影响Chart"></canvas>
                        </div>
                    </div>
                    
                    <div id="客户影响Result" class="result-section dimension-result">
                        <h3>客户影响维度权重</h3>
                        <div class="chart-container">
                            <canvas id="客户影响Chart"></canvas>
                        </div>
                    </div>
                    
                    <div id="创新影响Result" class="result-section dimension-result">
                        <h3>创新影响维度权重</h3>
                        <div class="chart-container">
                            <canvas id="创新影响Chart"></canvas>
                        </div>
                    </div>
                    
                    <div id="环境影响Result" class="result-section dimension-result">
                        <h3>环境影响维度权重</h3>
                        <div class="chart-container">
                            <canvas id="环境影响Chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        Chart.register(ChartDataLabels);

        let categoryChart = null;
        let dimensionCharts = {};

        function updateChart(chartId, data, existingChart) {
            const ctx = document.getElementById(chartId).getContext('2d');
            
            if (existingChart) {
                existingChart.destroy();
            }
            
            return new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: data.map(item => item.name),
                    datasets: [{
                        data: data.map(item => item.weight),
                        backgroundColor: [
                            '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', 
                            '#FF9F40', '#9966FF', '#FF99CC', '#99FF99'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        datalabels: {
                            color: '#fff',
                            font: {
                                weight: 'bold',
                                size: 12
                            },
                            formatter: (value) => value.toFixed(1) + '%'
                        },
                        legend: {
                            position: 'right',
                            labels: {
                                font: {
                                    size: 12
                                },
                                boxWidth: 15,
                                padding: 10
                            }
                        }
                    },
                    layout: {
                        padding: {
                            left: 0,
                            right: 0,
                            top: 0,
                            bottom: 0
                        }
                    }
                }
            });
        }

        function calculateCategoryWeights() {
            const categories = document.querySelectorAll('.category-item');
            const scores = {};
            let total = 0;
            
            categories.forEach(cat => {
                const name = cat.querySelector('span').textContent;
                const score = parseFloat(cat.querySelector('.score-input').value) || 0;
                scores[name] = score;
                total += score;
            });
            
            const results = Object.entries(scores)
                .map(([name, score]) => ({
                    name,
                    weight: total > 0 ? (score / total * 100) : 0
                }))
                .sort((a, b) => b.weight - a.weight);
            
            categoryChart = updateChart('categoryChart', results, categoryChart);
        }

        function calculateDimensionWeights() {
            // 获取所有价值分类
            const categories = ['商业影响', '行业影响', '客户影响', '创新影响', '环境影响'];
            
            categories.forEach(category => {
                // 获取该分类下的所有维度
                const dimensions = document.querySelectorAll(`.value-column:nth-child(${categories.indexOf(category) + 1}) .dimension-box`);
                const scores = {};
                let total = 0;
                
                dimensions.forEach(dim => {
                    const name = dim.querySelector('span').textContent;
                    const score = parseFloat(dim.querySelector('.score-input').value) || 0;
                    scores[name] = score;
                    total += score;
                });
                
                const results = Object.entries(scores)
                    .map(([name, score]) => ({
                        name,
                        weight: total > 0 ? (score / total * 100) : 0
                    }))
                    .sort((a, b) => b.weight - a.weight);
                
                // 更新该分类的饼图
                dimensionCharts[category] = updateChart(
                    `${category}Chart`,
                    results,
                    dimensionCharts[category]
                );
            });
        }

        // 为所有输入框添加验证
        document.querySelectorAll('.score-input').forEach(input => {
            input.addEventListener('input', function() {
                let value = parseFloat(this.value);
                if (value < 0) this.value = 0;
                if (value > 10) this.value = 10;
            });
        });

        // 添加窗口大小改变时重新调整图表大小的功能
        window.addEventListener('resize', function() {
            if (categoryChart) {
                categoryChart.resize();
            }
            Object.values(dimensionCharts).forEach(chart => {
                if (chart) {
                    chart.resize();
                }
            });
        });
    </script>
</body>
</html>
